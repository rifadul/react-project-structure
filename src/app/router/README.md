# React Protected Routes

## Description

React Protected Routes is a React application that dynamically generates protected routes based on a navigation menu configuration. It uses a recursive route creation mechanism to handle various navigation item types, secured by an `AuthGuard` middleware for authentication and authorization. This project is designed to provide a scalable and maintainable routing structure for React applications using React Router.

## Installation

To set up the project locally, follow these steps:

1. Clone the repository:
    ```bash
    git clone https://github.com/your-username/react-protected-routes.git
    ```
2. Navigate to the project directory:
    ```bash
    cd react-protected-routes
    ```
3. Install dependencies:
    ```bash
    npm install
    ```
4. Start the development server:
    ```bash
    npm start
    ```

## Usage

This project provides a dynamic routing system where routes are generated from a `navigationMenus` configuration. The routes are wrapped in an `AuthGuard` component to ensure only authorized users can access them. To use the routing system, define your navigation menu structure in `src/navigation/navigationMenus.js` and integrate the `protectedRoutes` configuration with React Router.

Example of integrating with React Router:

```javascript
import { createBrowserRouter, RouterProvider } from 'react-router-dom';
import { protectedRoutes } from './routes';

const router = createBrowserRouter([protectedRoutes]);

function App() {
    return <RouterProvider router={router} />;
}
```

## Route Creation Documentation

### Overview

This module processes a navigation menu structure defined in `navigationMenus` and converts it into a set of protected routes wrapped in an `AuthGuard` component. It uses a recursive function `createRouteFromMenu` to handle different types of menu items and generate corresponding route objects compatible with React Router.

### Dependencies

-   **NAV_TYPE**: Enum or constant object imported from `../../constants/app.constant`, defining navigation item types (`ITEM`, `COLLAPSE`, `HIDDEN`).
-   **AuthGuard**: A middleware component imported from `../../middleware/AuthGuard`, used to protect routes by enforcing authentication or authorization checks.
-   **navigationMenus**: An array of menu configuration objects imported from `../navigation/navigationMenus`, containing the structure and details of navigation items.

### Key Components

#### `createRouteFromMenu` Function

This recursive function transforms a menu configuration object into a route object compatible with React Router's route configuration.

##### Parameters

-   `menu`: A menu configuration object with the following properties:
    -   `type`: The type of menu item (`NAV_TYPE.ITEM`, `NAV_TYPE.COLLAPSE`, or `NAV_TYPE.HIDDEN`).
    -   `path`: The URL path for the route.
    -   `component`: The React component to render for the route (optional).
    -   `childs`: An array of child menu items for nested routes (optional).

##### Logic

1. **Base Case (ITEM or HIDDEN without children)**:

    - If the menu item is of type `NAV_TYPE.ITEM` or `NAV_TYPE.HIDDEN` with no children, it creates a simple route object:
        ```javascript
        {
            path: menu.path,
            lazy: async () => ({
                Component: menu.component,
            }),
        }
        ```
    - The `lazy` property enables lazy loading of the component.

2. **Recursive Case (COLLAPSE or HIDDEN with children)**:

    - If the menu item is of type `NAV_TYPE.COLLAPSE` or `NAV_TYPE.HIDDEN` and has children, it creates a route with nested child routes:
        ```javascript
        {
            path: menu.path,
            children: menu.childs.map(createRouteFromMenu),
        }
        ```
    - The `children` array is generated by recursively applying `createRouteFromMenu` to each child menu item.

3. **Fallback Case**:
    - If the menu item has a `component` defined but does not match the above cases, it creates a route object similar to the base case:
        ```javascript
        {
            path: menu.path,
            lazy: async () => ({
                Component: menu.component,
            }),
        }
        ```
    - If no `component` is defined, it returns `undefined`.

##### Return Value

-   A route object with `path`, `lazy`, and optionally `children` properties, or `undefined` if the menu item cannot be converted to a valid route.

### Route Generation

The `navigationMenus` array is mapped through `createRouteFromMenu` to generate an array of route objects. The `filter(Boolean)` method removes any `undefined` values from the resulting array:

```javascript
const routes = navigationMenus?.map(createRouteFromMenu).filter(Boolean);
```

### Protected Routes

The generated routes are wrapped in a single `protectedRoutes` object, which uses the `AuthGuard` component to protect all routes:

```javascript
const protectedRoutes = {
    id: 'protected',
    Component: AuthGuard,
    children: [...routes],
};
```

-   **id**: A unique identifier for the route group (`protected`).
-   **Component**: The `AuthGuard` component, which wraps all child routes to enforce authentication or authorization.
-   **children**: The array of route objects generated from `navigationMenus`.

### Exported Values

-   **protectedRoutes**: The main export, a route configuration object that can be used with React Router to define protected routes in the application.

### Usage Example

Assuming `navigationMenus` contains:

```javascript
const navigationMenus = [
    {
        type: NAV_TYPE.ITEM,
        path: '/dashboard',
        component: DashboardComponent,
    },
    {
        type: NAV_TYPE.COLLAPSE,
        path: '/settings',
        childs: [
            {
                type: NAV_TYPE.ITEM,
                path: '/settings/profile',
                component: ProfileComponent,
            },
        ],
    },
];
```

The module will generate:

```javascript
const protectedRoutes = {
    id: 'protected',
    Component: AuthGuard,
    children: [
        {
            path: '/dashboard',
            lazy: async () => ({
                Component: DashboardComponent,
            }),
        },
        {
            path: '/settings',
            children: [
                {
                    path: '/settings/profile',
                    lazy: async () => ({
                        Component: ProfileComponent,
                    }),
                },
            ],
        },
    ],
};
```

This configuration can be used with React Router's `createBrowserRouter` or similar APIs to set up protected routes.

### Notes

-   The module assumes that `navigationMenus` is an array of valid menu objects with consistent properties (`type`, `path`, `component`, `childs`).
-   The `lazy` property ensures components are loaded asynchronously, improving performance for large applications.
-   The `AuthGuard` component is responsible for handling authentication/authorization logic, which is not defined in this module.
-   The use of `filter(Boolean)` ensures that invalid or incomplete menu items (returning `undefined`) are excluded from the final routes.

## Contributing

Contributions are welcome! To contribute:

1. Fork the repository.
2. Create a new branch (`git checkout -b feature/your-feature`).
3. Make your changes and commit (`git commit -m "Add your feature"`).
4. Push to the branch (`git push origin feature/your-feature`).
5. Open a pull request.

Please ensure your code follows the project's coding standards and includes relevant tests.

## License

MIT License - see [LICENSE](./LICENSE) for details.
